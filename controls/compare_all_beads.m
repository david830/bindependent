% auto generated by colorModel.py, modified by us

stem1031 = '../../2012-10-31-Triplicate_full_set/Controls/';
stem1106 = '../../2012-11-06-LmrA-data/controls/';
stem1107 = '../../2012-11-07-Time_series_x2/';
stem1110 = '../../2012-11-10-Last_set/Controls/';

% Omitted: 10/31 #3 (bad beads)
names = {'10/31 #1', '10/31 #2', '11/06 #1', '11/06 #2', '11/07 T58', '11/07 T16+', '11/07 T24+', '11/07 T26+', '11/10 #1', '11/10 #2'};
peak_thresholds = [300 200 500 200 300 200 300 300 300 300]; % for the beadfiles, not the CMfiles
beadfiles = {[stem1031 'BEADS-1_H7_H07_P3.fcs'], ...
             [stem1031 'BEADS-2_H7_H07_P3.fcs'], ...
             [stem1106 '2012-10-31_BEADS-1_real_P3.fcs'], ...
             [stem1106 '2012-10-31_BEADS-2_real_P3.fcs'], ...
             [stem1107 'T58/2012-11-07_BEADS-T58_P3.fcs'], ...
             [stem1107 'Time_data/2012-11-07_BEADS-T16-22_60_P3.fcs'], ...
             [stem1107 'Time_data/2012-11-07_BEADS-T24_42_63_P3.fcs'], ...
             [stem1107 'Time_data/2012-11-07_BEADS-T26_28_30_48_69_72_P3.fcs'], ...
             [stem1110 '2012-10-31_BEADS-1_P3.fcs'], ...
             [stem1110 '2012-10-31_BEADS-2_P3.fcs']};
CMfiles = {'1031control1/CM121031-1', ...
           '1031control2/CM121031-2', ...
           '1106control/CM121106', ...
           '1106beads2/CM121106-2', ...
           '1107controlT58/control1/CM121107-1.mat', ...
           '1107controlT16p/CM121107-T16p.mat', ...
           '1107controlT24p/CM121107-T24p.mat', ...
           '1107controlT26p/CM121107-T26p.mat', ...
           '1110control/CM121110', ...
           '1110beads2/CM121110-2'};

ratio_matrix = zeros(numel(CMfiles),numel(beadfiles),3);

for i=1:numel(CMfiles),
    load(CMfiles{i});
    for j=1:numel(beadfiles),
        CM = set_bead_peak_threshold(CM,peak_thresholds(j));
        [beads_ok bead_ratios] = check_beads_identical(CM,beadfiles{j});
        ratio_matrix(i,j,:) = bead_ratios;
    end
end

colors = {'Blue','Red','Yellow'};
for i=1:3,
    h = figure('PaperPosition',[1 1 11 6]);
    imagesc(1:numel(CMfiles),1:numel(beadfiles),ratio_matrix(:,:,i),[0.75 1.25]);
    % colormap(gray); %% uncomment for grayscale version
    colorbar;
    xlabel('Base Set','FontSize',16);
    ylabel('Comparison Set','FontSize',16);
    title(sprintf('Bead Alignment: %s Channel',colors{i}),'FontSize',16);
    set(gca,'XTickLabel',names);
    set(gca,'YTickLabel',names);
    set(gca,'FontSize',11);
    
    outputfig(h,sprintf('bead-alignment-matrix-%s',colors{i}));
end

save('-V7','BeadRatios.mat','names','peak_thresholds','beadfiles','CMfiles','ratio_matrix');
